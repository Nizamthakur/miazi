<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review | Goynakotha </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="{% static 'images/icons/favicon.png' %}"/>
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'fonts/font-awesome-4.7.0/css/font-awesome.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'fonts/iconic/css/material-design-iconic-font.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'fonts/linearicons-v1.0.0/icon-font.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/animate/animate.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/css-hamburgers/hamburgers.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/animsition/css/animsition.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/select2/select2.min.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/daterangepicker/daterangepicker.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/slick/slick.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/MagnificPopup/magnific-popup.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'vendor/perfect-scrollbar/perfect-scrollbar.css' %}">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/util.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
    <!--===============================================================================================-->
<!-- Facebook Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1370732264288445');
    fbq('track', 'PageView');
    </script>
    <noscript>
    <img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1370732264288445&ev=PageView&noscript=1"/>
    </noscript>
    <!-- End Facebook Meta Pixel Code -->
</head>
    <style>
        :root {
            --primary: #2A2A2A;
            --accent: #4A90E2;
            --light-bg: #F9FAFB;
            --text: #4A5568;
        }

        body {
            background: var(--light-bg);
            min-height: 100vh;
            font-family: 'Inter', sans-serif;
            padding: 0;
        }

        .review-container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto; /* Add this */
            padding: 0 15px; /* Add padding for mobile */
        }

        .review-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .review-title {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
            position: relative;
            display: inline-block;
            padding-top: 80px;
        }

        .review-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: var(--accent);
        }

        .review-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .review-card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .review-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        }

        .review-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--accent);
            transform: scaleY(0);
            transition: transform 0.4s ease;
        }

        .review-card:hover::before {
            transform: scaleY(1);
        }

        .user-meta {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .user-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            margin-right: 1rem;
            object-fit: cover;
            border: 2px solid var(--accent);
            padding: 2px;
        }

        .user-info {
            flex: 1;
        }

        .review-name {
            font-size: 1.1rem;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .review-date {
            font-size: 0.9rem;
            color: #718096;
        }

        .review-rating {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 1rem;
        }

        .rating-star {
            color: #CBD5E0;
            font-size: 1.2rem;
            transition: color 0.3s ease;
        }

        .rating-star.active {
            color: #F6AD55;
        }

        .review-card:hover .rating-star.active {
            color: #DD6B20;
        }

        .review-content {
            color: var(--text);
            line-height: 1.6;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .review-content::before {
            content: '“';
            position: absolute;
            top: -1.5rem;
            left: -0.5rem;
            font-size: 4rem;
            color: var(--accent);
            opacity: 0.1;
            font-family: serif;
        }

        .social-proof {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .social-link {
            display: flex;
            align-items: center;
            color: var(--accent);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .social-link i {
            margin-right: 0.5rem;
        }

        .social-link:hover {
            color: #2C5282;
        }

        @media (max-width: 768px) {
            .review-title {
                font-size: 2rem;
            }

            .review-grid {
                grid-template-columns: 1fr;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .review-card {
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
        }

        .review-card:nth-child(1) { animation-delay: 0.1s; }
        .review-card:nth-child(2) { animation-delay: 0.3s; }
        .review-card:nth-child(3) { animation-delay: 0.5s; }
        .main-content-wrapper {
            flex: 1;
            width: 100%;
            padding-bottom: 30px;
        }
    </style>
</head>
<body>
<div class ="main-content-wrapper">
<!-- Header -->
    <header>
        <!-- Header desktop -->
        <div class="container-menu-desktop">
            <!-- Topbar -->


            <div class="wrap-menu-desktop">
                <nav class="limiter-menu-desktop container">

                    <!-- Logo desktop -->
                    <a href="{% url 'home' %}" class="logo" style="margin-top:20px;">
                        <img src="{% static 'images/icons/logo1.png' %}" alt="IMG-LOGO">
                    </a>

                    <!-- Menu desktop -->
                    <div class="menu-desktop">
                        <ul class="main-menu">
                            <li class="active-menu">
                                <a href="{% url 'home' %}">Home</a>
                            </li>
                            <li>
                                <a href="{% url 'product_view' %}">Shop</a>
                            </li>

                            <li class="label1" data-label1="hot">
                                <a href="{% url 'featured_products' %}">Features</a>
                            </li>

<!--                            <li>-->
<!--                                <a href="blog.html">Blog</a>-->
<!--                            </li>-->

<!--                            <li>-->
<!--                                <a href="about.html">About</a>-->
<!--                            </li>-->

                            <li>
                                <a href="{% url 'contact' %}">Contact</a>
                            </li>
                        </ul>
                    </div>

                    <!-- Icon header -->

                </nav>
            </div>
        </div>

        <!-- Header Mobile -->
        <div class="wrap-header-mobile">
            <!-- Logo mobile -->
            <div class="logo-mobile">
                <a href="{% url 'home' %}"><img src="{% static 'images/icons/logo1.png' %}" alt="IMG-LOGO"></a>
            </div>



            <!-- Button show menu -->
            <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </div>
        </div>

        <!-- Menu Mobile -->
        <div class="menu-mobile">


            <ul class="main-menu-m">
                <li>
                    <a href="{% url 'home' %}">Home</a>
<!--                    <span class="arrow-main-menu-m">-->
<!--                        <i class="fa fa-angle-right" aria-hidden="true"></i>-->
<!--                    </span>-->
                </li>

                <li>
                    <a href="{% url 'product_view' %}">Shop</a>
                </li>

                <li>
                    <a href="{% url 'featured_products' %}" class="label1 rs1" data-label1="hot">Features</a>
                </li>

<!--                <li>-->
<!--                    <a href="blog.html">Blog</a>-->
<!--                </li>-->

<!--                <li>-->
<!--                    <a href="about.html">About</a>-->
<!--                </li>-->

                <li>
                    <a href="{% url 'contact' %}">Contact</a>
                </li>
            </ul>
        </div>
    </header>


    <section class="review-container">
        <div class="review-header">
            <h1 class="review-title">Customer Experiences</h1>
        </div>

        <div class="review-grid">
            {% for review in reviews %}
            <div class="review-card">
                <div class="user-meta">
                    <img src="{{ review.image.url }}" alt="{{ review.name }}" class="user-avatar">
                    <div class="user-info">
                        <h3 class="review-name">{{ review.name }}</h3>
                        <span class="review-date">{{ review.date }}</span>
                    </div>
                </div>

                <div class="review-rating">
                    {% for i in star_range %}
                    <i class="fas fa-star rating-star {% if i <= review.rating %}active{% endif %}"></i>
                    {% endfor %}
                </div>

                <p class="review-content">{{ review.text }}</p>

                <div class="social-proof">
                    <a href="{{ review.facebook_link }}" class="social-link" target="_blank">
                        <i class="fab fa-facebook-f"></i>
                        View Profile
                    </a>
                    <div class="verified-badge">
                        <i class="fas fa-check-circle"></i>
                        Verified Purchase
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    </div>
<!-- Footer -->
    <footer class="bg3 p-t-75 p-b-32">
        <div class="container">
            <div class="row">


                <div class="col-sm-6 col-lg-4 p-b-50">
                    <h4 class="stext-301 cl0 p-b-30">
                        Help Desk
                    </h4>

                    <ul>
                        <li class="p-b-10">
                            <a href="https://steadfast.com.bd/tracking" class="stext-107 cl7 hov-cl1 trans-04">
                                Track Order
                            </a>
                        </li>

                        <li class="p-b-10">
                            <a href="{% url 'return_policy' %}" class="stext-107 cl7 hov-cl1 trans-04">
                                Return policy
                            </a>
                        </li>

                        <li class="p-b-10">
                            <a href="{% url 'shipping_partners' %}" class="stext-107 cl7 hov-cl1 trans-04">
                                Shipping Partners
                            </a>
                        </li>
                        <li class="p-b-10">
                            <a href="{% url 'exchange_policy' %}" class="stext-107 cl7 hov-cl1 trans-04">
                                Exchange policy
                            </a>
                        </li>


                    </ul>
                </div>

                <div class="col-sm-6 col-lg-4 p-b-50">
                    <h4 class="stext-301 cl0 p-b-30">
                        GET IN TOUCH
                    </h4>

                    <p class="stext-107 cl7 size-201">
                        Any questions? Let us know in store at 192/A , Tilpapara, Khilgaon, Dhaka 1219 or call us on +8801840-154903.
                    </p>

                   <div class="p-t-27">
                        <a href="https://www.facebook.com/profile.php?id=61572220262415" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
                            <i class="fa fa-facebook"></i>
                        </a>

                        <a href="https://www.instagram.com/miabaaba/" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
                            <i class="fa fa-instagram"></i>
                        </a>

                        <a href="https://wa.me/8801707365693?text=Hello%2C%20I%20have%20a%20question%20about%20your%20products%20of%20Miabaaba!" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
                            <i class="fa fa-whatsapp"></i> <!-- Added WhatsApp -->
                        </a>


                    </div>
                </div>

                <div class="col-sm-6 col-lg-4 p-b-50">
                    <h4 class="stext-301 cl0 p-b-30">
                        Newsletter
                    </h4>

                    <form>
                        <div class="wrap-input1 w-full p-b-4">
                            <input class="input1 bg-none plh1 stext-107 cl7" type="text" name="email" placeholder="email@example.com">
                            <div class="focus-input1 trans-04"></div>
                        </div>

                        <div class="p-t-18">
                            <button class="flex-c-m stext-101 cl0 size-103 bg1 bor1 hov-btn2 p-lr-15 trans-04">
                                Subscribe
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="p-t-40">
               <div class="flex-c-m flex-w p-b-18">
                <a href="#" class="m-all-1">
                    <img class="payment-logo" src="{% static 'images/icons/Bkash-Logo.svg' %}" alt="ICON-PAY">
                </a>

                <a href="#" class="m-all-1">
                    <img class="payment-logo" src="{% static 'images/icons/nagad.png' %}" alt="ICON-PAY">
                </a>

                <a href="#" class="m-all-1">
                    <img class="payment-logo" src="{% static 'images/icons/icon-pay-02.png' %}" alt="ICON-PAY">
                </a>

                <a href="#" class="m-all-1">
                    <img class="payment-logo" src="{% static 'images/icons/icon-pay-03.png' %}" alt="ICON-PAY">
                </a>

                <a href="#" class="m-all-1">
                    <img class="payment-logo" src="{% static 'images/icons/icon-pay-04.png' %}" alt="ICON-PAY">
                </a>

                <a href="#" class="m-all-1">
                    <img class="payment-logo" src="{% static 'images/icons/icon-pay-05.png' %}" alt="ICON-PAY">
                </a>
            </div>

                <p class="stext-107 cl6 txt-center">
                    Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | by <a href="https://teccmark.com" target="_blank">Miabaaba</a>
                </p>
            </div>
        </div>
    </footer>






<!--===============================================================================================-->
<script src="{% static 'vendor/jquery/jquery-3.2.1.min.js' %}"></script>
<!--===============================================================================================-->
<script src="{% static 'vendor/animsition/js/animsition.min.js' %}"></script>
<!--===============================================================================================-->
<script src="{% static 'vendor/bootstrap/js/popper.js' %}"></script>
<script src="{% static 'vendor/bootstrap/js/bootstrap.min.js' %}"></script>
<!--===============================================================================================-->
<script src="{% static 'vendor/select2/select2.min.js' %}"></script>
<script>
    function initSelect2() {
        $(".js-select2").each(function(){
            $(this).select2({
                minimumResultsForSearch: 20,
                dropdownParent: $(this).next('.dropDownSelect2')
            });
        });
    }
    initSelect2();
</script>
<!--===============================================================================================-->
<script src="{% static 'vendor/daterangepicker/moment.min.js' %}"></script>
<script src="{% static 'vendor/daterangepicker/daterangepicker.js' %}"></script>
<!--===============================================================================================-->
<script src="{% static 'vendor/slick/slick.min.js' %}"></script>
<script src="{% static 'js/slick-custom.js' %}"></script>
<!--===============================================================================================-->
<script src="{% static 'vendor/parallax100/parallax100.js' %}"></script>
<script>
    $('.parallax100').parallax100();
</script>
<!--===============================================================================================-->
<script src="{% static 'vendor/MagnificPopup/jquery.magnific-popup.min.js' %}"></script>
<script>
    function initMagnificPopup() {
        $('.gallery-lb').each(function() {
            $(this).magnificPopup({
                delegate: 'a',
                type: 'image',
                gallery: { enabled: true },
                mainClass: 'mfp-fade'
            });
        });
    }
    initMagnificPopup();
</script>
<!--===============================================================================================-->
<script src="{% static 'vendor/isotope/isotope.pkgd.min.js' %}"></script>
<!--===============================================================================================-->
<script src="{% static 'vendor/sweetalert/sweetalert.min.js' %}"></script>
<script>
    // Wishlist functionality
    const handleWishlist = (element, message) => {
        const productId = element.closest('[data-product-id]')?.dataset.productId;
        if (!productId) return;

        fetch(`/wishlist/add/${productId}/`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('wishlist-count').dataset.notify = data.count;
                swal(message, '', 'success');
            })
            .catch(error => {
                swal('Please login first!', '', 'error');
            });
    };

    document.querySelectorAll('.js-addwish-b2, .js-addwish-detail').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            handleWishlist(this, 'Added to wishlist!');
        });
    });

    // Quick View with vertical thumbnails
    document.addEventListener('DOMContentLoaded', function() {
        // Quick View Modal
        document.querySelectorAll('.js-show-modal1').forEach(button => {
            button.addEventListener('click', async function(e) {
                e.preventDefault();
                const productId = this.dataset.productId;

                try {
                    const response = await fetch(`/products/${productId}/quick-view/`);
                    const data = await response.json();

                    // Price display
                    const priceHtml = data.sale_price
                        ? `<span class="stext-105 cl3" style="text-decoration: line-through;">৳${data.price}</span>
                           <span class="stext-105 cl1 p-l-10">৳${data.sale_price}</span>`
                        : `<span class="stext-105 cl3">৳${data.price}</span>`;

                    // Size selector
                    const sizeSelector = data.sizes.length > 0 ? `
                        <div class="flex-w flex-r-m p-b-10">
                            <div class="size-203 flex-c-m respon6">Size</div>
                            <div class="size-204 respon6-next">
                                <div class="rs1-select2 bor8 bg0">
                                    <select class="js-select2 size-select"
                                        ${['size', 'both'].includes(data.mandatory) ? 'required' : ''}>
                                        <option value="">Choose size</option>
                                        ${data.sizes.map(size => `
                                            <option value="${size}">${size}</option>
                                        `).join('')}
                                    </select>
                                    <div class="dropDownSelect2"></div>
                                </div>
                            </div>
                        </div>` : '';

                    // Color selector
                    const colorSelector = data.colors.length > 0 ? `
                        <div class="flex-w flex-r-m p-b-10">
                            <div class="size-203 flex-c-m respon6">Color</div>
                            <div class="size-204 respon6-next">
                                <div class="rs1-select2 bor8 bg0">
                                    <select class="js-select2 color-select"
                                        ${['color', 'both'].includes(data.mandatory) ? 'required' : ''}>
                                        <option value="">Choose color</option>
                                        ${data.colors.map(color => `
                                            <option value="${color}">${color}</option>
                                        `).join('')}
                                    </select>
                                    <div class="dropDownSelect2"></div>
                                </div>
                            </div>
                        </div>` : '';

                    // Thumbnails and main image
                    const imageSections = `
                        <div class="row">
                            <div class="col-3 pr-2">
                                <div class="vertical-thumbnails">
                                    ${data.images.map((image, index) => `
                                        <div class="thumbnail-item ${index === 0 ? 'active' : ''}"
                                            data-index="${index}">
                                            <img src="${image}"
                                                alt="Thumbnail ${index + 1}"
                                                class="img-fluid">
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="col-9 pl-2">
                                <div class="slick3 gallery-lb">
                                    ${data.images.map(image => `
                                        <div class="item-slick3" data-thumb="${image}">
                                            <div class="wrap-pic-w pos-relative">
                                                <img src="${image}" alt="${data.name}">
                                                <a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04"
                                                    href="${image}">
                                                    <i class="fa fa-expand"></i>
                                                </a>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>`;

                    // Full HTML template
                    const quickViewHTML = `
                        <div class="row">
                            <div class="col-md-6 col-lg-7 p-b-30">
                                <div class="p-l-25 p-r-30 p-lr-0-lg">
                                    ${imageSections}
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-5 p-b-30">
                                <div class="p-r-50 p-t-5 p-lr-0-lg">
                                    <h4 class="mtext-105 cl2 js-name-detail p-b-14">${data.name}</h4>
                                    <div class="flex-w mb-3">
                                        <span class="stext-102 cl3">SKU: ${data.sku}</span>
                                    </div>
                                    ${priceHtml}
                                    <p class="stext-102 cl3 p-t-23">${data.description}</p>
                                    <div class="p-t-33">
                                        ${sizeSelector}
                                        ${colorSelector}
                                        <div class="flex-w flex-r-m p-b-10">
                                            <div class="size-204 flex-w flex-m respon6-next">
                                                <div class="wrap-num-product flex-w m-r-20 m-tb-10">
                                                    <div class="btn-num-product-down cl8 hov-btn3 trans-04 flex-c-m">
                                                        <i class="fs-16 zmdi zmdi-minus"></i>
                                                    </div>
                                                    <input class="mtext-104 cl3 txt-center num-product"
                                                        type="number" name="quantity" value="1" min="1">
                                                    <div class="btn-num-product-up cl8 hov-btn3 trans-04 flex-c-m">
                                                        <i class="fs-16 zmdi zmdi-plus"></i>
                                                    </div>
                                                </div>
                                                <button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-quickview"
                                                    data-product-id="${productId}"
                                                    data-mandatory="${data.mandatory}">
                                                    Add to cart
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>`;

                    const quickViewContent = document.getElementById('quick-view-content');
                    quickViewContent.innerHTML = quickViewHTML;

                    // Reinitialize plugins
                    initSelect2();
                    initMagnificPopup();

                    // Initialize slick slider
                    const slider = $('.slick3').slick({
                        slidesToShow: 1,
                        slidesToScroll: 1,
                        arrows: true,
                        fade: true,
                        dots: true,
                        appendDots: '.wrap-slick3-dots',
                        dotsClass: 'slick3-dots',
                        appendArrows: '.wrap-slick3-arrows',
                        prevArrow: '<button class="arrow-slick3 prev-slick3"><i class="fa fa-angle-left"></i></button>',
                        nextArrow: '<button class="arrow-slick3 next-slick3"><i class="fa fa-angle-right"></i></button>',
                    });

                    // Thumbnail click handler
                    document.querySelectorAll('.thumbnail-item').forEach(thumbnail => {
                        thumbnail.addEventListener('click', function() {
                            const index = parseInt(this.dataset.index);
                            document.querySelectorAll('.thumbnail-item').forEach(item =>
                                item.classList.remove('active'));
                            this.classList.add('active');
                            slider.slick('slickGoTo', index);
                        });
                    });

                    $('.js-modal1').addClass('show-modal1');

                } catch (error) {
                    swal('Error loading product details!', '', 'error');
                    console.error('Error:', error);
                }
            });
        });

        // Add to cart handler
        document.addEventListener('click', async (e) => {
            if(e.target.classList.contains('js-addcart-quickview')) {
                e.preventDefault();
                const button = e.target;
                const productId = button.dataset.productId;
                const mandatory = button.dataset.mandatory;
                const quantityInput = button.closest('.respon6-next').querySelector('.num-product');
                const quantity = parseInt(quantityInput.value) || 1;

                // Get selections
                const size = document.querySelector('.size-select')?.value || '';
                const color = document.querySelector('.color-select')?.value || '';

                // Validate mandatory fields
                let errorMsg = '';
                if(mandatory === 'both' && (!size || !color)) {
                    errorMsg = 'Please select both size and color';
                } else if(mandatory === 'size' && !size) {
                    errorMsg = 'Please select a size';
                } else if(mandatory === 'color' && !color) {
                    errorMsg = 'Please select a color';
                }

                if(errorMsg) return swal(errorMsg, '', 'warning');

                try {
                    const response = await fetch(`/cart/add/${productId}/`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken'),
                        },
                        body: JSON.stringify({
                            quantity: quantity,
                            size: size,
                            color: color
                        })
                    });

                    const data = await response.json();

                    if(data.success) {
                        swal('Added to cart!', '', 'success');
                        document.querySelectorAll('.icon-header-noti').forEach(icon => {
                            icon.dataset.notify = data.cart_count;
                        });
                    } else {
                        throw new Error(data.message || 'Failed to add to cart');
                    }
                } catch (error) {
                    swal(error.message, '', 'error');
                    console.error('Error:', error);
                }
            }
        });

        // Quantity buttons
        document.addEventListener('click', (e) => {
            const wrapNum = e.target.closest('.wrap-num-product');
            if (!wrapNum) return;

            const input = wrapNum.querySelector('.num-product');
            let value = parseInt(input.value) || 1;

            if(e.target.closest('.btn-num-product-down')) {
                input.value = value > 1 ? value - 1 : 1;
            }
            else if(e.target.closest('.btn-num-product-up')) {
                input.value = value + 1;
            }
        });

        // Close modal
        document.querySelectorAll('.js-hide-modal1').forEach(button => {
            button.addEventListener('click', () => {
                $('.js-modal1').removeClass('show-modal1');
            });
        });

        // CSRF helper
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    });
</script>
<!--===============================================================================================-->
<script src="{% static 'vendor/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
<script>
    function initPerfectScrollbar() {
        $('.js-pscroll').each(function(){
            new PerfectScrollbar(this, {
                wheelSpeed: 1,
                scrollingThreshold: 1000,
                wheelPropagation: false,
            });
        });
    }
    initPerfectScrollbar();
</script>
<!--===============================================================================================-->
<script src="{% static 'js/main.js' %}"></script>
</body>
</html>